<app-dash></app-dash>

<div class="container-fluid mt-4"> 
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3">Gestión de Proyectos</h1>
    <button class="btn btn-primary" (click)="crearProyecto()">
      <i class="bi bi-plus-circle"></i> Nuevo Proyecto
    </button>
  </div>

  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Lista de Proyectos</h5>
    </div>

    <div class="card-body">
     
      <div class="d-flex justify-content-between align-items-center mb-3">
      
        <div class="flex-grow-1 me-3">
          <div class="input-group">
            <input type="text" class="form-control"
              [(ngModel)]="searchTerm"
              (input)="applyFilter()"
              placeholder="Buscar proyectos por ID, nombre, email..." />
            <button *ngIf="searchTerm" class="btn btn-outline-secondary"
              (click)="searchTerm=''; applyFilter()">
              <i class="bi bi-x-circle"></i>
            </button>
          </div>
        </div>

     
        <mat-paginator [length]="dataSource.filteredData.length"
                       [pageSizeOptions]="[5, 10, 15, 20]"
                       showFirstLastButton
                       aria-label="Selector de página">
        </mat-paginator>
      </div>

     
      <table class="table table-hover align-middle w-100">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Usuario</th>
            <th>Email</th>
            <th>Ciudad</th>
            <th>Dirección</th>
            <th>Coordenadas</th>
            <th>Teléfono</th>
            <th>Sitio Web</th>
            <th>Compañía</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
         
          <tr *ngFor="let proyecto of dataSource.connect() | async">
            <td>{{ proyecto.id }}</td>
            <td>{{ proyecto.name }}</td>
            <td>{{ proyecto.username }}</td>
            <td>{{ proyecto.email }}</td>
            <td>{{ proyecto.address.city }}</td>
            <td>{{ obtenerDireccionCompleta(proyecto) }}</td>
            <td>{{ obtenerCoordenadas(proyecto) }}</td>
            <td>{{ proyecto.phone }}</td>
            <td>{{ proyecto.website }}</td>
            <td>{{ proyecto.company.name }}</td>
            <td>
              <div class="btn-group" role="group">
                <button class="btn btn-sm btn-primary" (click)="verTareas(proyecto.id)">
                  <i class="bi bi-eye"></i> Ver Tareas
                </button>
                <button class="btn btn-sm btn-warning" (click)="editarProyecto(proyecto.id)">
                  <i class="bi bi-pencil"></i> Editar
                </button>
                <button class="btn btn-sm btn-danger" (click)="eliminarProyecto(proyecto.id, proyecto.name)">
                  <i class="bi bi-trash"></i> Borrar
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
